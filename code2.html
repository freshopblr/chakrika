<!DOCTYPE html>
<html>
<head>
<title>Secure LGS Tool</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<style type="text/css">
body {font-family: Times New Roman;
background-image:url("pic.png");
image-size:200%;
text-align: center; font-size: 200%}
h2 {font-size: 200%}
</style>
</head>
<body>
<h2>üîê LGS Encryption & Decryption</h2>
<label for="inputText">Message:</label><br>
<textarea id="inputText" rows="4" cols="50" placeholder="Enter your message or encrypted text"></textarea><br><br>
<label for="secretKey">Secret Key:</label><br>
<input type="password" id="secretKey" placeholder="Enter your secret key"><br><br>
<button onclick="encryptMessage()">Encrypt</button>
<button onclick="decryptMessage()">Decrypt</button><br><br>
<label for="outputText">Output:</label><br>
<textarea id="outputText" rows="4" cols="50" readonly></textarea>
<script>
    function encryptMessage() {
      const message = document.getElementById("inputText").value;
      const key = document.getElementById("secretKey").value;
      
      if (!message || !key) {
        alert("Please enter both a message and a secret key.");
        return;
      }
      
      // Check for password strength
      if (!isStrongKey(key)) {
        return;
      }
      
      const encrypted = CryptoJS.AES.encrypt(message, key).toString();
      document.getElementById("outputText").value = encrypted;
    }

    function decryptMessage() {
      const encryptedText = document.getElementById("inputText").value;
      const key = document.getElementById("secretKey").value;
      
      if (!encryptedText || !key) {
        alert("Please enter both encrypted text and the secret key.");
        return;
      }
      
      try {
        const decrypted = CryptoJS.AES.decrypt(encryptedText, key);
        const plaintext = decrypted.toString(CryptoJS.enc.Utf8);
        if (!plaintext) {
          throw new Error("Invalid key or corrupted data.");
        }
        document.getElementById("outputText").value = plaintext;
      } catch (e) {
        document.getElementById("outputText").value = "‚ùå Decryption failed. Check your key or input.";
      }
    }

    // Add this new function to check password strength
    function isStrongKey(key) {
      // Common password list
      const commonPasswords = [
        "password", "123456", "12345678", "qwerty", "abc123", "letmein",
        "monkey", "admin", "welcome", "password1", "1234", "12345",
        "secret", "123123", "654321", "master", "hello", "111111",
        "sunshine", "football", "baseball", "soccer", "princess", "dragon",
        "superman", "batman", "trustno1", "iloveyou", "starwars", "ashley",
        "shadow", "michael", "jennifer", "000000", "passw0rd", "charlie"
      ];
      
      // Check for common passwords
      if (commonPasswords.includes(key.toLowerCase())) {
        alert("Security alert: You're using a commonly known password. Please choose a stronger key.");
        return false;
      }
      
      // Check for minimum length
      if (key.length < 8) {
        alert("Your key must be at least 8 characters long.");
        return false;
      }
      
      // Check for complexity (must contain at least one number and one special character)
      const hasNumber = /\d/.test(key);
      const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(key);
      
      if (!hasNumber || !hasSpecial) {
        alert("Your key must contain at least one number and one special character.");
        return false;
      }
      
      return true;
    }
</script>
</body>

</html>
